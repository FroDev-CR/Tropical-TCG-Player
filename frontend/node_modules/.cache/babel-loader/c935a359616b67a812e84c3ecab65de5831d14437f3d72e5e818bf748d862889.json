{"ast":null,"code":"// src/components/RatingSystem.js\n// Sistema completo de calificaciones P2P\nimport React,{useState,useEffect}from'react';import{Modal,Button,Form,Alert,Card,Badge,Row,Col}from'react-bootstrap';import{useP2PTransactions}from'../hooks/useP2PTransactions';import RatingStars from'./RatingStars';import'./RatingSystem.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function RatingSystem(_ref){var _transaction$items,_transaction$items$,_transaction$totalAmo,_transaction$createdA,_transaction$createdA2,_transaction$createdA3;let{show,onHide,transaction,userRole,// 'buyer' | 'seller'\nonRatingSubmitted}=_ref;const{handleRatingSubmission,actionLoading,error}=useP2PTransactions();const[rating,setRating]=useState({overall:0,categories:{communication:0,reliability:0,productQuality:0,// Solo para compradores\ndeliveryTime:0,// Solo para compradores\nprofessionalism:0// Solo para vendedores calificando compradores\n}});const[comment,setComment]=useState('');const[isAnonymous,setIsAnonymous]=useState(false);const[submissionStep,setSubmissionStep]=useState('rating');// 'rating' | 'confirmation' | 'success'\n// Datos del otro participante\nconst[otherParticipant,setOtherParticipant]=useState(null);useEffect(()=>{if(transaction&&userRole){const participant=userRole==='buyer'?{name:transaction.sellerName,role:'vendedor',phone:transaction.sellerPhone,email:transaction.sellerEmail}:{name:transaction.buyerName,role:'comprador',phone:transaction.buyerPhone,email:transaction.buyerEmail};setOtherParticipant(participant);}},[transaction,userRole]);// Resetear form cuando se abre el modal\nuseEffect(()=>{if(show){setRating({overall:0,categories:{communication:0,reliability:0,productQuality:0,deliveryTime:0,professionalism:0}});setComment('');setIsAnonymous(false);setSubmissionStep('rating');}},[show]);// Calcular rating promedio automáticamente\nuseEffect(()=>{const categories=rating.categories;const relevantCategories=userRole==='buyer'?[categories.communication,categories.reliability,categories.productQuality,categories.deliveryTime]:[categories.communication,categories.reliability,categories.professionalism];const nonZeroRatings=relevantCategories.filter(r=>r>0);if(nonZeroRatings.length>0){const average=nonZeroRatings.reduce((sum,r)=>sum+r,0)/nonZeroRatings.length;setRating(prev=>({...prev,overall:Math.round(average)}));}},[rating.categories,userRole]);const handleCategoryRatingChange=(category,value)=>{setRating(prev=>({...prev,categories:{...prev.categories,[category]:value}}));};const handleOverallRatingChange=value=>{setRating(prev=>({...prev,overall:value}));};const validateRating=()=>{if(rating.overall===0){return{valid:false,message:'Debes seleccionar una calificación general'};}const requiredCategories=userRole==='buyer'?['communication','reliability','productQuality','deliveryTime']:['communication','reliability','professionalism'];const missingCategories=requiredCategories.filter(cat=>rating.categories[cat]===0);if(missingCategories.length>0){return{valid:false,message:'Debes calificar todas las categorías requeridas'};}return{valid:true};};const handleSubmit=async()=>{const validation=validateRating();if(!validation.valid){alert(validation.message);return;}setSubmissionStep('confirmation');};const confirmSubmission=async()=>{try{const ratingData={rating:rating.overall,comment:comment.trim(),categories:rating.categories,isAnonymous};await handleRatingSubmission(transaction.id,ratingData);setSubmissionStep('success');// Notificar al componente padre\nonRatingSubmitted&&onRatingSubmitted(ratingData);// Cerrar modal después de 2 segundos\nsetTimeout(()=>{onHide();},2000);}catch(error){console.error('Error enviando calificación:',error);setSubmissionStep('rating');}};const getCategoryLabel=category=>{const labels={communication:'Comunicación',reliability:'Confiabilidad',productQuality:'Calidad del Producto',deliveryTime:'Tiempo de Entrega',professionalism:'Profesionalismo'};return labels[category]||category;};const getCategoryDescription=category=>{const descriptions={communication:'¿Qué tan bien se comunicó durante la transacción?',reliability:'¿Cumplió con lo acordado y fue confiable?',productQuality:'¿La calidad del producto coincidió con la descripción?',deliveryTime:'¿Entregó en el tiempo prometido?',professionalism:'¿Se comportó de manera profesional y respetuosa?'};return descriptions[category]||'';};const getRatingColor=rating=>{if(rating>=4.5)return'success';if(rating>=3.5)return'warning';if(rating>=2.5)return'info';return'danger';};if(!transaction||!otherParticipant){return null;}return/*#__PURE__*/_jsxs(Modal,{show:show,onHide:onHide,size:\"lg\",className:\"rating-system-modal\",backdrop:submissionStep==='success'?false:'static',keyboard:submissionStep!=='confirmation',children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:submissionStep!=='confirmation',className:\"border-0\",children:/*#__PURE__*/_jsxs(Modal.Title,{className:\"d-flex align-items-center\",children:[\"\\u2B50 Calificar Experiencia\",/*#__PURE__*/_jsx(Badge,{bg:\"info\",className:\"ms-2\",children:userRole==='buyer'?'Como Comprador':'Como Vendedor'})]})}),/*#__PURE__*/_jsxs(Modal.Body,{children:[error&&/*#__PURE__*/_jsxs(Alert,{variant:\"danger\",className:\"mb-4\",children:[/*#__PURE__*/_jsx(Alert.Heading,{children:\"Error\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mb-0\",children:error})]}),/*#__PURE__*/_jsx(Card,{className:\"transaction-summary mb-4\",children:/*#__PURE__*/_jsx(Card.Body,{className:\"p-3\",children:/*#__PURE__*/_jsxs(Row,{className:\"align-items-center\",children:[/*#__PURE__*/_jsxs(Col,{md:8,children:[/*#__PURE__*/_jsx(\"h6\",{className:\"mb-1\",children:((_transaction$items=transaction.items)===null||_transaction$items===void 0?void 0:(_transaction$items$=_transaction$items[0])===null||_transaction$items$===void 0?void 0:_transaction$items$.cardName)||'Transacción'}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-muted small\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"me-3\",children:[\"\\uD83D\\uDCB0 \\u20A1\",(_transaction$totalAmo=transaction.totalAmount)===null||_transaction$totalAmo===void 0?void 0:_transaction$totalAmo.toLocaleString()]}),/*#__PURE__*/_jsxs(\"span\",{className:\"me-3\",children:[\"\\uD83D\\uDCC5 \",(_transaction$createdA=transaction.createdAt)===null||_transaction$createdA===void 0?void 0:(_transaction$createdA2=_transaction$createdA.toDate)===null||_transaction$createdA2===void 0?void 0:(_transaction$createdA3=_transaction$createdA2.call(_transaction$createdA))===null||_transaction$createdA3===void 0?void 0:_transaction$createdA3.toLocaleDateString('es-CR')]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"#\",transaction.id.slice(-8)]})]})]}),/*#__PURE__*/_jsx(Col,{md:4,className:\"text-end\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"participant-info\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"fw-bold\",children:otherParticipant.name}),/*#__PURE__*/_jsx(\"div\",{className:\"text-muted small\",children:otherParticipant.role})]})})]})})}),submissionStep==='rating'&&/*#__PURE__*/_jsxs(\"div\",{className:\"rating-form\",children:[/*#__PURE__*/_jsxs(Card,{className:\"mb-4\",children:[/*#__PURE__*/_jsx(Card.Header,{className:\"bg-light\",children:/*#__PURE__*/_jsx(\"h6\",{className:\"mb-0\",children:\"\\uD83C\\uDF1F Calificaci\\xF3n General\"})}),/*#__PURE__*/_jsxs(Card.Body,{className:\"text-center py-4\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"mb-3\",children:[\"\\xBFC\\xF3mo calificar\\xEDas tu experiencia general con \",otherParticipant.name,\"?\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"overall-rating mb-3\",children:/*#__PURE__*/_jsx(RatingStars,{rating:rating.overall,onRatingChange:handleOverallRatingChange,size:\"large\",interactive:true})}),/*#__PURE__*/_jsx(\"div\",{className:\"rating-labels\",children:/*#__PURE__*/_jsxs(\"small\",{className:\"text-muted\",children:[rating.overall===0&&'Selecciona una calificación',rating.overall===1&&'⭐ Muy malo',rating.overall===2&&'⭐⭐ Malo',rating.overall===3&&'⭐⭐⭐ Regular',rating.overall===4&&'⭐⭐⭐⭐ Bueno',rating.overall===5&&'⭐⭐⭐⭐⭐ Excelente']})})]})]}),/*#__PURE__*/_jsxs(Card,{className:\"mb-4\",children:[/*#__PURE__*/_jsx(Card.Header,{className:\"bg-light\",children:/*#__PURE__*/_jsx(\"h6\",{className:\"mb-0\",children:\"\\uD83D\\uDCCA Calificaciones Detalladas\"})}),/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsx(Row,{children:Object.keys(rating.categories).map(category=>{// Filtrar categorías según el rol\nif(userRole==='buyer'&&category==='professionalism')return null;if(userRole==='seller'&&(category==='productQuality'||category==='deliveryTime'))return null;return/*#__PURE__*/_jsx(Col,{md:6,className:\"mb-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"category-rating\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"category-header mb-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"category-label fw-bold\",children:getCategoryLabel(category)}),/*#__PURE__*/_jsx(\"div\",{className:\"category-description small text-muted\",children:getCategoryDescription(category)})]}),/*#__PURE__*/_jsx(\"div\",{className:\"category-stars\",children:/*#__PURE__*/_jsx(RatingStars,{rating:rating.categories[category],onRatingChange:value=>handleCategoryRatingChange(category,value),size:\"medium\",interactive:true})})]})},category);})})})]}),/*#__PURE__*/_jsxs(Card,{className:\"mb-4\",children:[/*#__PURE__*/_jsx(Card.Header,{className:\"bg-light\",children:/*#__PURE__*/_jsx(\"h6\",{className:\"mb-0\",children:\"\\uD83D\\uDCAC Comentario (Opcional)\"})}),/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsxs(Form.Group,{children:[/*#__PURE__*/_jsx(Form.Control,{as:\"textarea\",rows:4,value:comment,onChange:e=>setComment(e.target.value),placeholder:`Comparte tu experiencia con ${otherParticipant.name}. Este comentario será visible públicamente...`,maxLength:500}),/*#__PURE__*/_jsxs(Form.Text,{className:\"text-muted\",children:[comment.length,\"/500 caracteres\"]})]}),/*#__PURE__*/_jsx(Form.Check,{type:\"checkbox\",id:\"anonymous-rating\",label:\"Calificaci\\xF3n an\\xF3nima (solo visible el rating, no tu nombre)\",checked:isAnonymous,onChange:e=>setIsAnonymous(e.target.checked),className:\"mt-3\"})]})]})]}),submissionStep==='confirmation'&&/*#__PURE__*/_jsxs(\"div\",{className:\"confirmation-step\",children:[/*#__PURE__*/_jsxs(Alert,{variant:\"info\",className:\"mb-4\",children:[/*#__PURE__*/_jsx(Alert.Heading,{children:\"\\uD83D\\uDD0D Confirma tu Calificaci\\xF3n\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"mb-0\",children:[\"Por favor revisa tu calificaci\\xF3n antes de enviarla.\",/*#__PURE__*/_jsx(\"strong\",{children:\" Una vez enviada no se puede modificar.\"})]})]}),/*#__PURE__*/_jsx(Card,{className:\"mb-4\",children:/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsxs(Col,{md:6,children:[/*#__PURE__*/_jsx(\"h6\",{children:\"\\uD83D\\uDCCA Resumen de Calificaci\\xF3n\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"rating-summary\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"overall-summary mb-3\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center justify-content-between\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Calificaci\\xF3n General:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(RatingStars,{rating:rating.overall,size:\"small\"}),/*#__PURE__*/_jsxs(Badge,{bg:getRatingColor(rating.overall),className:\"ms-2\",children:[rating.overall,\"/5\"]})]})]})}),Object.keys(rating.categories).map(category=>{if(userRole==='buyer'&&category==='professionalism')return null;if(userRole==='seller'&&(category==='productQuality'||category==='deliveryTime'))return null;return/*#__PURE__*/_jsx(\"div\",{className:\"category-summary mb-2\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center justify-content-between\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"small\",children:[getCategoryLabel(category),\":\"]}),/*#__PURE__*/_jsx(RatingStars,{rating:rating.categories[category],size:\"small\"})]})},category);})]})]}),/*#__PURE__*/_jsxs(Col,{md:6,children:[/*#__PURE__*/_jsx(\"h6\",{children:\"\\uD83D\\uDCAC Tu Comentario\"}),/*#__PURE__*/_jsx(\"div\",{className:\"comment-preview\",children:comment.trim()?/*#__PURE__*/_jsx(\"div\",{className:\"border rounded p-3 bg-light\",children:/*#__PURE__*/_jsx(\"p\",{className:\"mb-0 small\",children:comment})}):/*#__PURE__*/_jsx(\"p\",{className:\"text-muted small\",children:\"Sin comentario\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"privacy-info mt-3\",children:/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:isAnonymous?/*#__PURE__*/_jsx(_Fragment,{children:\"\\uD83D\\uDD12 Calificaci\\xF3n an\\xF3nima - Tu nombre no ser\\xE1 visible\"}):/*#__PURE__*/_jsx(_Fragment,{children:\"\\uD83D\\uDC64 Calificaci\\xF3n p\\xFAblica - Tu nombre ser\\xE1 visible\"})})})]})]})})})]}),submissionStep==='success'&&/*#__PURE__*/_jsxs(\"div\",{className:\"success-step text-center py-5\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"success-icon mb-3\",children:\"\\u2705\"}),/*#__PURE__*/_jsx(\"h4\",{className:\"text-success mb-3\",children:\"\\xA1Calificaci\\xF3n Enviada!\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-muted mb-4\",children:[\"Gracias por calificar tu experiencia con \",otherParticipant.name,\". Tu feedback ayuda a mejorar la comunidad.\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"final-rating\",children:[/*#__PURE__*/_jsx(RatingStars,{rating:rating.overall,size:\"large\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-2\",children:/*#__PURE__*/_jsxs(Badge,{bg:getRatingColor(rating.overall),className:\"fs-6\",children:[rating.overall,\"/5 Estrellas\"]})})]})]})]}),/*#__PURE__*/_jsxs(Modal.Footer,{className:\"border-0\",children:[submissionStep==='rating'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:onHide,children:\"Cancelar\"}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:handleSubmit,disabled:rating.overall===0,children:\"Revisar Calificaci\\xF3n\"})]}),submissionStep==='confirmation'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Button,{variant:\"outline-secondary\",onClick:()=>setSubmissionStep('rating'),children:\"\\u2190 Editar\"}),/*#__PURE__*/_jsx(Button,{variant:\"success\",onClick:confirmSubmission,disabled:actionLoading,children:actionLoading?'⏳ Enviando...':'✅ Confirmar y Enviar'})]}),submissionStep==='success'&&/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:onHide,className:\"mx-auto\",children:\"Cerrar\"})]})]});}","map":{"version":3,"names":["React","useState","useEffect","Modal","Button","Form","Alert","Card","Badge","Row","Col","useP2PTransactions","RatingStars","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","RatingSystem","_ref","_transaction$items","_transaction$items$","_transaction$totalAmo","_transaction$createdA","_transaction$createdA2","_transaction$createdA3","show","onHide","transaction","userRole","onRatingSubmitted","handleRatingSubmission","actionLoading","error","rating","setRating","overall","categories","communication","reliability","productQuality","deliveryTime","professionalism","comment","setComment","isAnonymous","setIsAnonymous","submissionStep","setSubmissionStep","otherParticipant","setOtherParticipant","participant","name","sellerName","role","phone","sellerPhone","email","sellerEmail","buyerName","buyerPhone","buyerEmail","relevantCategories","nonZeroRatings","filter","r","length","average","reduce","sum","prev","Math","round","handleCategoryRatingChange","category","value","handleOverallRatingChange","validateRating","valid","message","requiredCategories","missingCategories","cat","handleSubmit","validation","alert","confirmSubmission","ratingData","trim","id","setTimeout","console","getCategoryLabel","labels","getCategoryDescription","descriptions","getRatingColor","size","className","backdrop","keyboard","children","Header","closeButton","Title","bg","Body","variant","Heading","md","items","cardName","totalAmount","toLocaleString","createdAt","toDate","call","toLocaleDateString","slice","onRatingChange","interactive","Object","keys","map","Group","Control","as","rows","onChange","e","target","placeholder","maxLength","Text","Check","type","label","checked","Footer","onClick","disabled"],"sources":["/home/frodev/Downloads/FroDev-CR-TropicalTCGPlayers/src/components/RatingSystem.js"],"sourcesContent":["// src/components/RatingSystem.js\n// Sistema completo de calificaciones P2P\n\nimport React, { useState, useEffect } from 'react';\nimport { Modal, Button, Form, Alert, Card, Badge, Row, Col } from 'react-bootstrap';\nimport { useP2PTransactions } from '../hooks/useP2PTransactions';\nimport RatingStars from './RatingStars';\nimport './RatingSystem.css';\n\nexport default function RatingSystem({ \n  show, \n  onHide, \n  transaction, \n  userRole, // 'buyer' | 'seller'\n  onRatingSubmitted \n}) {\n  const { handleRatingSubmission, actionLoading, error } = useP2PTransactions();\n  \n  const [rating, setRating] = useState({\n    overall: 0,\n    categories: {\n      communication: 0,\n      reliability: 0,\n      productQuality: 0, // Solo para compradores\n      deliveryTime: 0,   // Solo para compradores\n      professionalism: 0 // Solo para vendedores calificando compradores\n    }\n  });\n  \n  const [comment, setComment] = useState('');\n  const [isAnonymous, setIsAnonymous] = useState(false);\n  const [submissionStep, setSubmissionStep] = useState('rating'); // 'rating' | 'confirmation' | 'success'\n  \n  // Datos del otro participante\n  const [otherParticipant, setOtherParticipant] = useState(null);\n\n  useEffect(() => {\n    if (transaction && userRole) {\n      const participant = userRole === 'buyer' \n        ? {\n            name: transaction.sellerName,\n            role: 'vendedor',\n            phone: transaction.sellerPhone,\n            email: transaction.sellerEmail\n          }\n        : {\n            name: transaction.buyerName,\n            role: 'comprador',\n            phone: transaction.buyerPhone,\n            email: transaction.buyerEmail\n          };\n      setOtherParticipant(participant);\n    }\n  }, [transaction, userRole]);\n\n  // Resetear form cuando se abre el modal\n  useEffect(() => {\n    if (show) {\n      setRating({\n        overall: 0,\n        categories: {\n          communication: 0,\n          reliability: 0,\n          productQuality: 0,\n          deliveryTime: 0,\n          professionalism: 0\n        }\n      });\n      setComment('');\n      setIsAnonymous(false);\n      setSubmissionStep('rating');\n    }\n  }, [show]);\n\n  // Calcular rating promedio automáticamente\n  useEffect(() => {\n    const categories = rating.categories;\n    const relevantCategories = userRole === 'buyer' \n      ? [categories.communication, categories.reliability, categories.productQuality, categories.deliveryTime]\n      : [categories.communication, categories.reliability, categories.professionalism];\n    \n    const nonZeroRatings = relevantCategories.filter(r => r > 0);\n    if (nonZeroRatings.length > 0) {\n      const average = nonZeroRatings.reduce((sum, r) => sum + r, 0) / nonZeroRatings.length;\n      setRating(prev => ({ ...prev, overall: Math.round(average) }));\n    }\n  }, [rating.categories, userRole]);\n\n  const handleCategoryRatingChange = (category, value) => {\n    setRating(prev => ({\n      ...prev,\n      categories: {\n        ...prev.categories,\n        [category]: value\n      }\n    }));\n  };\n\n  const handleOverallRatingChange = (value) => {\n    setRating(prev => ({ ...prev, overall: value }));\n  };\n\n  const validateRating = () => {\n    if (rating.overall === 0) {\n      return { valid: false, message: 'Debes seleccionar una calificación general' };\n    }\n\n    const requiredCategories = userRole === 'buyer' \n      ? ['communication', 'reliability', 'productQuality', 'deliveryTime']\n      : ['communication', 'reliability', 'professionalism'];\n\n    const missingCategories = requiredCategories.filter(cat => rating.categories[cat] === 0);\n    if (missingCategories.length > 0) {\n      return { \n        valid: false, \n        message: 'Debes calificar todas las categorías requeridas' \n      };\n    }\n\n    return { valid: true };\n  };\n\n  const handleSubmit = async () => {\n    const validation = validateRating();\n    if (!validation.valid) {\n      alert(validation.message);\n      return;\n    }\n\n    setSubmissionStep('confirmation');\n  };\n\n  const confirmSubmission = async () => {\n    try {\n      const ratingData = {\n        rating: rating.overall,\n        comment: comment.trim(),\n        categories: rating.categories,\n        isAnonymous\n      };\n\n      await handleRatingSubmission(transaction.id, ratingData);\n      setSubmissionStep('success');\n      \n      // Notificar al componente padre\n      onRatingSubmitted && onRatingSubmitted(ratingData);\n      \n      // Cerrar modal después de 2 segundos\n      setTimeout(() => {\n        onHide();\n      }, 2000);\n    } catch (error) {\n      console.error('Error enviando calificación:', error);\n      setSubmissionStep('rating');\n    }\n  };\n\n  const getCategoryLabel = (category) => {\n    const labels = {\n      communication: 'Comunicación',\n      reliability: 'Confiabilidad',\n      productQuality: 'Calidad del Producto',\n      deliveryTime: 'Tiempo de Entrega',\n      professionalism: 'Profesionalismo'\n    };\n    return labels[category] || category;\n  };\n\n  const getCategoryDescription = (category) => {\n    const descriptions = {\n      communication: '¿Qué tan bien se comunicó durante la transacción?',\n      reliability: '¿Cumplió con lo acordado y fue confiable?',\n      productQuality: '¿La calidad del producto coincidió con la descripción?',\n      deliveryTime: '¿Entregó en el tiempo prometido?',\n      professionalism: '¿Se comportó de manera profesional y respetuosa?'\n    };\n    return descriptions[category] || '';\n  };\n\n  const getRatingColor = (rating) => {\n    if (rating >= 4.5) return 'success';\n    if (rating >= 3.5) return 'warning';\n    if (rating >= 2.5) return 'info';\n    return 'danger';\n  };\n\n  if (!transaction || !otherParticipant) {\n    return null;\n  }\n\n  return (\n    <Modal \n      show={show} \n      onHide={onHide} \n      size=\"lg\" \n      className=\"rating-system-modal\"\n      backdrop={submissionStep === 'success' ? false : 'static'}\n      keyboard={submissionStep !== 'confirmation'}\n    >\n      <Modal.Header closeButton={submissionStep !== 'confirmation'} className=\"border-0\">\n        <Modal.Title className=\"d-flex align-items-center\">\n          ⭐ Calificar Experiencia\n          <Badge bg=\"info\" className=\"ms-2\">\n            {userRole === 'buyer' ? 'Como Comprador' : 'Como Vendedor'}\n          </Badge>\n        </Modal.Title>\n      </Modal.Header>\n\n      <Modal.Body>\n        {error && (\n          <Alert variant=\"danger\" className=\"mb-4\">\n            <Alert.Heading>Error</Alert.Heading>\n            <p className=\"mb-0\">{error}</p>\n          </Alert>\n        )}\n\n        {/* Transaction Summary */}\n        <Card className=\"transaction-summary mb-4\">\n          <Card.Body className=\"p-3\">\n            <Row className=\"align-items-center\">\n              <Col md={8}>\n                <h6 className=\"mb-1\">\n                  {transaction.items?.[0]?.cardName || 'Transacción'}\n                </h6>\n                <div className=\"text-muted small\">\n                  <span className=\"me-3\">\n                    💰 ₡{transaction.totalAmount?.toLocaleString()}\n                  </span>\n                  <span className=\"me-3\">\n                    📅 {transaction.createdAt?.toDate?.()?.toLocaleDateString('es-CR')}\n                  </span>\n                  <span>\n                    #{transaction.id.slice(-8)}\n                  </span>\n                </div>\n              </Col>\n              <Col md={4} className=\"text-end\">\n                <div className=\"participant-info\">\n                  <div className=\"fw-bold\">{otherParticipant.name}</div>\n                  <div className=\"text-muted small\">{otherParticipant.role}</div>\n                </div>\n              </Col>\n            </Row>\n          </Card.Body>\n        </Card>\n\n        {/* Rating Steps */}\n        {submissionStep === 'rating' && (\n          <div className=\"rating-form\">\n            {/* Overall Rating */}\n            <Card className=\"mb-4\">\n              <Card.Header className=\"bg-light\">\n                <h6 className=\"mb-0\">🌟 Calificación General</h6>\n              </Card.Header>\n              <Card.Body className=\"text-center py-4\">\n                <p className=\"mb-3\">\n                  ¿Cómo calificarías tu experiencia general con {otherParticipant.name}?\n                </p>\n                <div className=\"overall-rating mb-3\">\n                  <RatingStars\n                    rating={rating.overall}\n                    onRatingChange={handleOverallRatingChange}\n                    size=\"large\"\n                    interactive={true}\n                  />\n                </div>\n                <div className=\"rating-labels\">\n                  <small className=\"text-muted\">\n                    {rating.overall === 0 && 'Selecciona una calificación'}\n                    {rating.overall === 1 && '⭐ Muy malo'}\n                    {rating.overall === 2 && '⭐⭐ Malo'}\n                    {rating.overall === 3 && '⭐⭐⭐ Regular'}\n                    {rating.overall === 4 && '⭐⭐⭐⭐ Bueno'}\n                    {rating.overall === 5 && '⭐⭐⭐⭐⭐ Excelente'}\n                  </small>\n                </div>\n              </Card.Body>\n            </Card>\n\n            {/* Category Ratings */}\n            <Card className=\"mb-4\">\n              <Card.Header className=\"bg-light\">\n                <h6 className=\"mb-0\">📊 Calificaciones Detalladas</h6>\n              </Card.Header>\n              <Card.Body>\n                <Row>\n                  {Object.keys(rating.categories).map((category) => {\n                    // Filtrar categorías según el rol\n                    if (userRole === 'buyer' && category === 'professionalism') return null;\n                    if (userRole === 'seller' && (category === 'productQuality' || category === 'deliveryTime')) return null;\n\n                    return (\n                      <Col md={6} key={category} className=\"mb-4\">\n                        <div className=\"category-rating\">\n                          <div className=\"category-header mb-2\">\n                            <div className=\"category-label fw-bold\">\n                              {getCategoryLabel(category)}\n                            </div>\n                            <div className=\"category-description small text-muted\">\n                              {getCategoryDescription(category)}\n                            </div>\n                          </div>\n                          <div className=\"category-stars\">\n                            <RatingStars\n                              rating={rating.categories[category]}\n                              onRatingChange={(value) => handleCategoryRatingChange(category, value)}\n                              size=\"medium\"\n                              interactive={true}\n                            />\n                          </div>\n                        </div>\n                      </Col>\n                    );\n                  })}\n                </Row>\n              </Card.Body>\n            </Card>\n\n            {/* Comment */}\n            <Card className=\"mb-4\">\n              <Card.Header className=\"bg-light\">\n                <h6 className=\"mb-0\">💬 Comentario (Opcional)</h6>\n              </Card.Header>\n              <Card.Body>\n                <Form.Group>\n                  <Form.Control\n                    as=\"textarea\"\n                    rows={4}\n                    value={comment}\n                    onChange={(e) => setComment(e.target.value)}\n                    placeholder={`Comparte tu experiencia con ${otherParticipant.name}. Este comentario será visible públicamente...`}\n                    maxLength={500}\n                  />\n                  <Form.Text className=\"text-muted\">\n                    {comment.length}/500 caracteres\n                  </Form.Text>\n                </Form.Group>\n                \n                <Form.Check\n                  type=\"checkbox\"\n                  id=\"anonymous-rating\"\n                  label=\"Calificación anónima (solo visible el rating, no tu nombre)\"\n                  checked={isAnonymous}\n                  onChange={(e) => setIsAnonymous(e.target.checked)}\n                  className=\"mt-3\"\n                />\n              </Card.Body>\n            </Card>\n          </div>\n        )}\n\n        {/* Confirmation Step */}\n        {submissionStep === 'confirmation' && (\n          <div className=\"confirmation-step\">\n            <Alert variant=\"info\" className=\"mb-4\">\n              <Alert.Heading>🔍 Confirma tu Calificación</Alert.Heading>\n              <p className=\"mb-0\">\n                Por favor revisa tu calificación antes de enviarla. \n                <strong> Una vez enviada no se puede modificar.</strong>\n              </p>\n            </Alert>\n\n            <Card className=\"mb-4\">\n              <Card.Body>\n                <Row>\n                  <Col md={6}>\n                    <h6>📊 Resumen de Calificación</h6>\n                    <div className=\"rating-summary\">\n                      <div className=\"overall-summary mb-3\">\n                        <div className=\"d-flex align-items-center justify-content-between\">\n                          <span>Calificación General:</span>\n                          <div className=\"d-flex align-items-center\">\n                            <RatingStars rating={rating.overall} size=\"small\" />\n                            <Badge bg={getRatingColor(rating.overall)} className=\"ms-2\">\n                              {rating.overall}/5\n                            </Badge>\n                          </div>\n                        </div>\n                      </div>\n                      \n                      {Object.keys(rating.categories).map((category) => {\n                        if (userRole === 'buyer' && category === 'professionalism') return null;\n                        if (userRole === 'seller' && (category === 'productQuality' || category === 'deliveryTime')) return null;\n                        \n                        return (\n                          <div key={category} className=\"category-summary mb-2\">\n                            <div className=\"d-flex align-items-center justify-content-between\">\n                              <span className=\"small\">{getCategoryLabel(category)}:</span>\n                              <RatingStars rating={rating.categories[category]} size=\"small\" />\n                            </div>\n                          </div>\n                        );\n                      })}\n                    </div>\n                  </Col>\n                  \n                  <Col md={6}>\n                    <h6>💬 Tu Comentario</h6>\n                    <div className=\"comment-preview\">\n                      {comment.trim() ? (\n                        <div className=\"border rounded p-3 bg-light\">\n                          <p className=\"mb-0 small\">{comment}</p>\n                        </div>\n                      ) : (\n                        <p className=\"text-muted small\">Sin comentario</p>\n                      )}\n                    </div>\n                    \n                    <div className=\"privacy-info mt-3\">\n                      <small className=\"text-muted\">\n                        {isAnonymous ? (\n                          <>🔒 Calificación anónima - Tu nombre no será visible</>\n                        ) : (\n                          <>👤 Calificación pública - Tu nombre será visible</>\n                        )}\n                      </small>\n                    </div>\n                  </Col>\n                </Row>\n              </Card.Body>\n            </Card>\n          </div>\n        )}\n\n        {/* Success Step */}\n        {submissionStep === 'success' && (\n          <div className=\"success-step text-center py-5\">\n            <div className=\"success-icon mb-3\">\n              ✅\n            </div>\n            <h4 className=\"text-success mb-3\">¡Calificación Enviada!</h4>\n            <p className=\"text-muted mb-4\">\n              Gracias por calificar tu experiencia con {otherParticipant.name}.\n              Tu feedback ayuda a mejorar la comunidad.\n            </p>\n            <div className=\"final-rating\">\n              <RatingStars rating={rating.overall} size=\"large\" />\n              <div className=\"mt-2\">\n                <Badge bg={getRatingColor(rating.overall)} className=\"fs-6\">\n                  {rating.overall}/5 Estrellas\n                </Badge>\n              </div>\n            </div>\n          </div>\n        )}\n      </Modal.Body>\n\n      <Modal.Footer className=\"border-0\">\n        {submissionStep === 'rating' && (\n          <>\n            <Button variant=\"secondary\" onClick={onHide}>\n              Cancelar\n            </Button>\n            <Button \n              variant=\"primary\" \n              onClick={handleSubmit}\n              disabled={rating.overall === 0}\n            >\n              Revisar Calificación\n            </Button>\n          </>\n        )}\n\n        {submissionStep === 'confirmation' && (\n          <>\n            <Button \n              variant=\"outline-secondary\" \n              onClick={() => setSubmissionStep('rating')}\n            >\n              ← Editar\n            </Button>\n            <Button \n              variant=\"success\" \n              onClick={confirmSubmission}\n              disabled={actionLoading}\n            >\n              {actionLoading ? '⏳ Enviando...' : '✅ Confirmar y Enviar'}\n            </Button>\n          </>\n        )}\n\n        {submissionStep === 'success' && (\n          <Button variant=\"primary\" onClick={onHide} className=\"mx-auto\">\n            Cerrar\n          </Button>\n        )}\n      </Modal.Footer>\n    </Modal>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}